fragment OrderFields on Order {
  id
  market {
    id
    name
    decimalPlaces
    positionDecimalPlaces
    tradableInstrument {
      instrument {
        id
        name
        code
      }
    }
  }
  type
  side
  size
  status
  rejectionReason
  price
  timeInForce
  remaining
  expiresAt
  createdAt
  updatedAt
}

fragment OrderConnectionFields on OrderEdge {
  node {
    ...OrderFields
  }
  cursor
}

query Orders($partyId: ID!, $pagination: Pagination) {
  party(id: $partyId) {
    id
    ordersConnection(pagination: $pagination) {
      edges {
        ...OrderConnectionFields
      }
      pageInfo {
        startCursor
        endCursor
        hasNextPage
        hasPreviousPage
      }
    }
  }
}

subscription OrderEvent($partyId: ID!) {
  orders(partyId: $partyId) {
    ...OrderFields
  }
}

fragment OrderBusEventFields on Order {
  type
  id
  status
  rejectionReason
  createdAt
  size
  price
  timeInForce
  expiresAt
  side
  market {
    id
    name
    decimalPlaces
    positionDecimalPlaces
  }
}

subscription OrderBusEvent($partyId: ID!) {
  busEvents(partyId: $partyId, batchSize: 0, types: [Order]) {
    type
    event {
      ... on Order {
        ...OrderBusEventFields
      }
    }
  }
}
