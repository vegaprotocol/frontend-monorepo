fragment WithdrawalAssetFields on Asset {
  id
  symbol
  name
  decimals
  status
  source {
    ... on ERC20 {
      contractAddress
    }
  }
}

fragment WithdrawalFields on Withdrawal {
  id
  status
  amount
  asset {
    ...WithdrawalAssetFields
  }
  createdTimestamp
  withdrawnTimestamp
  txHash
  details {
    ... on Erc20WithdrawalDetails {
      receiverAddress
    }
  }
  pendingOnForeignChain @client
}

fragment PendingWithdrawal on Withdrawal {
  pendingOnForeignChain @client
  txHash
}

fragment WithdrawalEdgeFields on WithdrawalEdge {
  node {
    ...WithdrawalFields
  }
}

query Withdrawals($partyId: ID!) {
  party(id: $partyId) {
    id
    withdrawalsConnection {
      edges {
        ...WithdrawalEdgeFields
      }
    }
  }
}

subscription WithdrawalEvent($partyId: ID!) {
  busEvents(partyId: $partyId, batchSize: 0, types: [Withdrawal]) {
    event {
      ... on Withdrawal {
        ...WithdrawalFields
      }
    }
  }
}

fragment WithdrawalFormAccountFields on Account {
  type
  balance
  asset {
    id
    symbol
  }
}

query WithdrawForm($partyId: ID!) {
  party(id: $partyId) {
    id
    withdrawals {
      id
      txHash
    }
    accounts {
      ...WithdrawalFormAccountFields
    }
  }
  assetsConnection {
    edges {
      node {
        ...WithdrawalAssetFields
      }
    }
  }
}
